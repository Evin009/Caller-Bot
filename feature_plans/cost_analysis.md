# Cost Analysis & Estimation

## Problem
Running voice AI tests involves costs from multiple providers:
- **Twilio**: Per-minute pricing for voice calls and phone numbers.
- **OpenAI (STT)**: Whisper API cost per minute of audio.
- **OpenAI (LLM)**: GPT-4 token usage (input/output).
- **TTS**: Cost per character for Text-to-Speech generation.

Without visibility, costs can accumulate unexpectedly during extensive testing.

## Proposed Solution
Implement a module to track and estimate the cost of each test run.

### Key Features
- **Per-Call Cost Breakdown**: Show estimated cost for Twilio, STT, LLM, and TTS for each call.
- **Total Run Cost**: Sum of costs for a batch of tests.
- **Budget Alerts**: Warn user if a planned test run is estimated to exceed a certain budget.
- **Usage Logging**: Log token counts and audio duration for audit purposes.

### Implementation Details
- **Configuration**: Store pricing rates in a config file (e.g., `config/pricing.yaml`).
- **Tracking**:
    - Wrap LLM calls to count tokens.
    - Track duration of recorded audio for STT cost.
    - Track character count of generated text for TTS cost.
    - Track total call duration for Twilio cost.
- **Reporting**: Add cost fields to the JSON report generated by `evaluation/reporter.py`.

### Benefits
- Helps manage project budget.
- Provides data to optimize test efficiency (e.g., shorter scenarios to save money).
- Increases awareness of resource consumption.
